include(${MBEDUTILS_TEST_DIR}/test_target.cmake)
create_test_target(
    TARGET
        TestNorFlash
    TEST_SOURCES
        test_nor_flash.cpp
    INSTRUMENTED_SOURCES
        ${PROJECT_SOURCE_DIR}/../mbedutils/src/memory/nvm/nor_flash.cpp
    DEPENDENT_SOURCES
        ${MBEDUTILS_TEST_EXPECT_DIR}/assert_expect.cpp
        ${MBEDUTILS_TEST_EXPECT_DIR}/gpio_intf_expect.cpp
        ${MBEDUTILS_TEST_EXPECT_DIR}/nor_flash_device_expect.cpp
        ${MBEDUTILS_TEST_EXPECT_DIR}/spi_intf_expect.cpp
        ${MBEDUTILS_TEST_EXPECT_DIR}/time_intf_expect.cpp
        ${MBEDUTILS_TEST_EXPECT_DIR}/mutex_intf_expect.cpp
        ${MBEDUTILS_TEST_MOCK_DIR}/assert_mock.cpp
        ${MBEDUTILS_TEST_MOCK_DIR}/gpio_intf_mock.cpp
        ${MBEDUTILS_TEST_MOCK_DIR}/mutex_intf_mock.cpp
        ${MBEDUTILS_TEST_MOCK_DIR}/nor_flash_device_mock.cpp
        ${MBEDUTILS_TEST_MOCK_DIR}/spi_intf_mock.cpp
        ${MBEDUTILS_TEST_MOCK_DIR}/time_intf_mock.cpp
    INCLUDE_DIRS
        ${TESTING_INCLUDE_DIRECTORIES}
    LIBRARIES
        mbedutils_headers
        mbedutils_internal_headers
    EXPORT_DIR ${CMAKE_CURRENT_BINARY_DIR}
)
